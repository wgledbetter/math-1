<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stan Math Library: doxygen/contributor_help_pages/developer_doc.md Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../$standoxy.css" rel="stylesheet" type="text/css">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../stanlogo-main.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://mc-stan.org/math">Stan Math Library</a>
   &#160;<span id="projectnumber">4.0.1</span>
   </div>
   <div id="projectbrief">Automatic Differentiation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d5/dbb/developer__doc_8md.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">doxygen/contributor_help_pages/developer_doc.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d5/dbb/developer__doc_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Developers Guide {#developer_guide}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Thanks for checking out these docs. This is where you&#39;ll find information on contributing to the [Math library](https://github.com/stan-dev/math), how the source code is laid out, and other technical details that could help. This wiki focuses on things relevant to the Math library. There&#39;s also a separate [Stan wiki](https://github.com/stan-dev/stan/wiki) for things related to the language, services, algorithms.</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;This wiki is a work in progress. If you have suggestions, please update the wiki or mention it on our forums on [this thread](https://discourse.mc-stan.org/t/what-doc-would-help-developers-of-the-math-library/).</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;-----------------</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;# Contents</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;- [Overview](#overview)</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;- [Licensing](#licensing)</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;- [Contributing](#contributing)</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;- [Code Review Guidelines](#code-review-guidelines)</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;- [Building and Running Tests (makefile documentation)](#building-and-running-tests)</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;- [Questions](#questions)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;-----------------</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;# Overview</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;The Stan Math library, referred to as Math or the Math library, is a C++ library for automatic differentiation. It&#39;s designed to be usable, extensive and extensible, efficient, scalable, stable, portable, and redistributable in order to facilitate the construction and utilization of algorithms that utilize derivatives.</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;The Math library implements:</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;- [reverse mode](https://en.wikipedia.org/wiki/Automatic_differentiation#Reverse_accumulation) automatic differentiation for computing gradients. This is fully tested and is utilized by [Stan](https://github.com/stan-dev/stan).</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;- [forward mode](https://en.wikipedia.org/wiki/Automatic_differentiation#Forward_accumulation) automatic differentiation for computing directional derivatives. This is not fully tested, but is close to complete.</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;- mixed mode automatic differentiation for computing higher order derivatives. Once forward mode is fully tested, this should work.</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;Some key features of the Math library&#39;s reverse mode automatic differentiation:</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;- object oriented design with overloading of operators</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;- arena-based memory management</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;For implementation details of the Math library&#39;s automatic differentiation, please read the arXiv paper &quot;[The Stan Math Library: Reverse-Mode Automatic Differentiation in C++](https://arxiv.org/abs/1509.07164).&quot;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;# Licensing</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;We&#39;re committed to having a permissive open-source license. The Math library is [licensed with the BSD 3-Clause License](https://github.com/stan-dev/math/blob/develop/LICENSE%2Emd) and we only accept changes to the code base that compatible with this license.</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;# Contributing</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;Thanks for reading! We love contributions from everyone in the form of good discussion, issues, and pull requests.</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;This is the short version. There&#39;s more information on the [wiki](https://github.com/stan-dev/math/wiki/Developer-Doc#contributing).</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;It is the responsibility of the contributor submitting the pull request that the code meets these requirements. We&#39;re open-source. Once the code gets into the code base, the community of developers take ownership of it.</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;## Issues</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;We reserve [issues](https://github.com/stan-dev/math/issues) for bugs and feature requests that are defined well enough for a developer to tackle. If you have general questions about the Math library, please see the [Discussion](#discussion) section.</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;### Bug Reports</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;Ideally, bug reports will include these pieces of information:</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;1. a description of the problem</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;2. a reproducible example</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;3. the expected outcome if the bug were fixed.</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;If there&#39;s an error and you can produce any of these pieces, it&#39;s much appreciated!</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;### Feature Requests</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;We track the development of new features using the same [issue tracker](https://github.com/stan-dev/math/issues). Ideally, feature requests will have:</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;1. a description of the feature</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;2. an example</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;3. the expected outcome if the feature existed.</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;Open feature requests should be the ones we want to implement in the Math library. We&#39;ll try to close vague feature requests that don&#39;t have enough information and move the discussion to the forums.</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;## Pull Requests</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;All changes to the Math library are handled through [pull requests](https://github.com/stan-dev/math/pulls). Each pull request should correspond to an issue. We follow a [modified GitFlow branching model](https://github.com/stan-dev/stan/wiki/Dev:-Git-Process) for development.</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;When a contributor creates a pull request for inclusion to the Math library, here are some of the things we expect:</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;1. the contribution maintains the Math library&#39;s open-source [license](https://github.com/stan-dev/math/wiki/Developer-Doc#licensing): 3-clause BSD</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;2. the code base remains stable after merging the pull request; we expect the `develop` branch to always be in a good state</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;3. the changes are maintainable. In code review, we look at the design of the proposed code. We also expect documentation.</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;4. the changes are tested. For bugs, we expect at least one test that fails before the patch and is fixed after the patch. For new features, we expect at least one test that shows expected behavior and one test that shows the behavior when there&#39;s an error.</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;5. the changes adhere to the Math library&#39;s [C++ standards](https://github.com/stan-dev/stan/wiki/Code-Quality). Consistency really helps.</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;Pull requests are code reviewed after they pass our continuous integration tests. We expect all the above before a pull request is merged. We are an open-source project and once code makes it into the repository, it&#39;s on the community to maintain.</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;### Code Reviews</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;See the [Code Review Guidelines](https://github.com/stan-dev/math/wiki/Developer-Doc#code-review-guidelines) on the Math wiki.</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;## Discussion</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;For general questions, please ask on the forums with the [&quot;Developers&quot; tag](https://discourse.mc-stan.org/c/stan-dev).</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;# Code Review Guidelines</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;All pull requests must have these things:</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;1. clear licensing information. Check that the person that owns the copyright is listed.</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;2. the code base remains stable after the merge. Every pull request should pass all the continuous integration tests. There are a very few exceptions when they don&#39;t, but that&#39;s rare.</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;3. the changes proposed are maintainable by the community. We&#39;re an open-source project. Once the changes go into the code base, we&#39;re all responsible for the code. Please read the code with these things in mind:</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    - overall readability. If it&#39;s hard to understand the code and it can be made simpler, please mention that.</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    - code design. It should either be designed with well-known C++ patterns or there should be a good reason it isn&#39;t.</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    - documentation. The documentation that goes with the changes should go in this pull request.</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;4. the changes are tested. Please verify that there&#39;s at least one new test that forces the code to execute. Please also verify there&#39;s at least one test that shows how to handle errors in the code. Having just these two tests (without full coverage) is usually enough to trap errors in the future. It is also enough to use these to refactor the code when the time comes.</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;5. the changes adhere to the Math library&#39;s [C++ standards](https://github.com/stan-dev/stan/wiki/Code-Quality). This is a large code base. We want the quality to be consistent so it&#39;s easy to navigate and understand other parts of the code base.</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;Most of the above is subjective, so please use your best judgement.</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;Pull requests should be narrow in scope. Please don&#39;t let inadvertent changes get into the code base.</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;## Who Can Review a Pull Request</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;It would help if anyone that&#39;s knowledgable in the code base reviews code. This is also for those that aren&#39;t active developers, but can read C++ fluently!</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;## Who Can Merge a Pull Request</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;Members of the Stan development team that contribute regularly to the Math library are allowed to merge the pull requests.</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;If all tests pass and the pull request has been reviewed, if no one merges, \@syclik will do so (not on any schedule, but at least once a week).</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;## How to Review a Pull Request</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;Thanks! Here are some guidelines on how to review. At a high level, you&#39;re making sure the code submitted is indeed what the submitter says they have submitted. If an issue exists and is good, then it should be fixed. There are lots of ways to solve a problem -- we&#39;re not always looking for the perfect solution. We&#39;re looking for something that can get into the code base without putting a maintenance burden on other developers.</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;Feel free to review a narrow part of the pull request. By that, I mean one of these things: build process, numerical computation, template metaprogramming. If you&#39;re reviewing a small portion of the pull request, please mention it in the comment and only mark it as a **comment** (not as an &quot;Approve&quot;). In most cases, this won&#39;t matter, but in the ones that span across different concerns, one of the core developers will coordinate the review and approve.</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;1. Before starting, review the linked Math issue. That issue should describe what should happen. The pull request will be how that happens.</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;2. Wait for the continuous integration to complete and pass. If the tests don&#39;t pass, the rest is optional.</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;3. Review the pull request text:</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    1. If any of the checklist is missing, please reject the pull request by leaving a comment for the submitter. If there&#39;s no response after some time, please close the pull request.</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    2. If the checklist is complete, read the description of the pull request. If the description of the fix doesn&#39;t seem right, comment on the pull request.</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    3. If the description of the tests don&#39;t seem like they are enough to keep the technical debt down, comment on the pull request asking for more tests. If you can, ask for specific tests.</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;4. Review the contents of the pull request. Dig into the code:</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    1. Verify that what was described is indeed what&#39;s happening in the code.</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    2. Spot check the tests to verify that they exist.</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    3. Verify documentation exists.</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    4. Check that the code is really readable. When you sign off, you&#39;re suggesting that someone else will be able to figure out the code to fix or modify it.</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    3. Add line-specific comments when you can.</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    4. Please check that there aren&#39;t other fixes or other code that sneaks into the pull request. Submitters shouldn&#39;t be sneaking in patches under the guise of a pull request.</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;5. &quot;Review Changes&quot; -- hit the green button and submit the review. We&#39;re playing within GitHub&#39;s rules, so we need to coordinate together. GitHub will allow the pull request to be merged when all continuous integration tests pass, there are no reviews that request changes, and at least one reviewer has approved. Pull requests are tricky because they can actually spawn across different concerns. Here&#39;s how we&#39;ll coordinate:</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    1. **Request changes**. If there are changes that need to be made, finalize your review with &quot;Request changes.&quot;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    2. **Comment**.  If you&#39;re only reviewing a portion of the pull request, e.g. numeric computation, finalize your review with &quot;Comment&quot; if everything is good.</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    3. **Approve**. Finalize the pull request with &quot;Approve&quot; when the pull request is ready to be merged. If you&#39;re looking at the whole pull request, then feel free to approve when it&#39;s ready. If you&#39;re only looking at a part of the pull request, please do not approve. One of the core Math developers will coordinate the different reviewers and approve based on the feedback.</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;# Building and Running Tests</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;**Nota bene:** these build instructions are not in the released version yet. This is for the `develop` branch (post v2.18.0. Prior to this, the build instructions are similar, but not identical.</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;## Overview</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;The Math library is designed as a header-only library. Everything is included in a single translation unit.</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;Some of the external libraries require libraries to be linked in. These are:</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;- SUNDIALS for ordinary differential equations solving</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;- Boost MPI</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;- OpenCL</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;Within the Math library, the only build targets are the tests (there are no other executables to build directly from Math). The makefile can be used to build other C++ executables, with all the correct compiler flags for Math.</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;## Makefile Variables</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;To customize how the tests are built in C++, variables can be set in a file called `make/local`. This is the preferred way of customizing the build. You can also set it more permanently by setting variables in `~/.config/stan/make.local`.</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;Note: variables in `make/local` override variables in `~/.config/stan/make/local`.</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;There are a lot of make variables that can be set. In general, `CXXFLAGS_*` is for C++ compiler flags, `CPPFLAGS_*` is for C preprocessor flags, `LDFLAGS_*` is for linker flags, and `LDLBIS_*` is for libraries that need to be linked in.</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;These are the more common make flags that could be set:</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;- `CXX`: C++ compiler</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;- `CXXFLAGS_OS`: compiler flags specific to the operating system.</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;- `CPPFLAGS_OS`: C preprocessor flags specific to the operating system.</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;- `O`: optimization level. Defaults to `3`.</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;- `INC_FIRST`: this is a C++ compiler option. If you need to include any headers before Math&#39;s headers, this is where to specify it. Default is empty.</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;- `LDFLAGS_OS`: linker flags for the operating system</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;- `LDLIBS_OS`: link libraries for the operating system</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;These are the rest of the variables that can be set:</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;- C++ compiler flags</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    - `CXXFLAGS_LANG`: sets the language. Currently defaults to `-std=c++1y`</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    - `CXXFLAGS_WARNINGS`: compiler options to squash compiler warnings</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    - `CXXFLAGS_BOOST`: Boost-specific compiler flags</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    - `CXXFLAGS_EIGEN`: Eigen-specific compiler flags</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    - `CXXFLAGS_OPENCL`: OpenCL-specific compiler flags</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    - `CXXFLAGS_MPI`: MPI-specific compiler flags</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;- C preprocessor flags</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    - `CPPFLAGS_LANG`:</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    - `CPPFLAGS_WARNINGS`</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    - `CPPFLAGS_BOOST`</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    - `CPPFLAGS_EIGEN`</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    - `CPPFLAGS_OPENCL`</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    - `CPPFLAGS_MPI`</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;- Linker flags</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    - `LDFLAGS_LANG`</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    - `LDFLAGS_WARNINGS`</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    - `LDFLAGS_BOOST`</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    - `LDFLAGS_EIGEN`</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    - `LDFLAGS_OPENCL`</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    - `LDFLAGS_MPI`</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;- Link libraries</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    - `LDLIBS_LANG`</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    - `LDLIBS_WARNINGS`</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    - `LDLIBS_BOOST`</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    - `LDLIBS_EIGEN`</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    - `LDLIBS_OPENCL`</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    - `LDLIBS_MPI`</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;- Misc</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    - `OS`: operating system. Defaults to `Darwin`, `Linux`, or `WindowsNT`.</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    - `MATH`: the location of the math library. Defaults to empty variable (used for Stan and CmdStan).</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    - `EIGEN`: location of the Eigen headers</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    - `BOOST`: location of the Boost headers</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    - `SUNDIALS`: location of the Sundials headers</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    - `INC`: the includes for the C++ compiler</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    - `INC_SUNDIALS`: the Sundials includes</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    - `INC_GTEST`: the Google test includes</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    - `EXE`: the executable file extension. On Windows, defaults to `.EXE`. On other operating system, defaults to an empty variable.</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;For debugging, there&#39;s a useful target for printing Stan variables. It&#39;s `print-*` where `*` is the variable. For example, on a Mac:</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;```</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;&gt; make print-CXX</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;CXX = clang++</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;```</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;## Building Tests</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;The main function of the makefiles is to build test executables. The typical way to build test executables is to use the `runTests.py` python script, but we can use make to directly generate a test executable.</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;The name of the test executable is the name of the test with the file extension removed for Linux and Mac or replacing the file extension with `.exe` for Windows. For example, to run the test `test/unit/math_include_test.cpp`, we build on Linux and Mac with:</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;```</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;&gt; make test/unit/math_include_test</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;```</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;or on Windows with:</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;```</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;&gt; make test/unit/math_include_test.exe</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;```</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;We can then run the executable from the command line.</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;### Rebuilding Tests</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;Along with the test executable, the makefiles generate dependency files. The dependency files are generated by using the C++ compiler to list the headers that the test depends on. The dependency file is automatically generated by make and included by make so it knows what header files the test depends on. If none of those files changed, then the executable doesn&#39;t need to be rebuilt.</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;We can build the dependency file directly. For the `test/unit/math_include_test.cpp` example, we can build the dependency file using make:</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;```</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;&gt; make test/unit/math_include_test.d</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;```</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;If you look at the first couple of lines, you&#39;ll see:</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;```</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;test/unit/math_include_test.o test/unit/math_include_test.d: \</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  test/unit/math_include_test.cpp stan/math.hpp stan/math/rev/mat.hpp \</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;```</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;Make uses the timestamp of the files to determine whether it needs to be rebuilt. If any of the files listed after the targets (after the `:`) are updated, the executable will be rebuilt. If you&#39;ve built all the unit tests and only change a single header file, building the unit tests again will selectively rebuild the tests that depends on that header.</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;## Running Tests</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;The easiest way to build and run tests is to use the `runTests.py` python script. To run unit tests:</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;```</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;&gt; ./runTests.py test/unit</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;```</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;## Misc: Stan Testing</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;The [Stan testing](https://github.com/stan-dev/stan/wiki/Testing-Stan-using-Gnu-Make-and-Python) process depends on the makefiles in Math.</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;# Where do I create a new issue</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;Stan&#39;s development is across multiple repositories. See this page for details on where to put new issues:</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;https://github.com/stan-dev/stan/wiki/Where-do-I-create-a-new-issue</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;# Running tests from the math library</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;Running tests in the Stan Math Library require these libraries, which are all included in the repository:</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;- Boost</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;- Eigen</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;- Google Test</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;- CppLint (optional)</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;No additional configuration is necessary to start running with the default libraries.</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;If you want to use custom locations for the library locations, set these makefile variables:</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;- `EIGEN`</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;- `BOOST`</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;- `GTEST`</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;- `CPPLINT` (optional)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;Example `~/.config/stan/make.local` file:</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;```</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;BOOST = ~/boost</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;```</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;# Running tests</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;To run tests, you will need a copy of the Math library, a C++ compiler, make, and python 2.x (for the test script).</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;To run the unit tests, type:</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;```</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;&gt; ./runTests.py test/unit</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;```</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;To run the auto-generated distribution tests, type:</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;```</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;&gt; ./runTests.py test/prob</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;```</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;To run the multiple translation unit tests, type:</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;```</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;&gt; ./runTests.py test/unit/multiple_translation_units_test.cpp</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;```</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;If you see this message:</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;```</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;------------------------------------------------------------</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;make generate-tests -s</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;test/prob/generate_tests.cpp:9:10: fatal error: &#39;boost/algorithm/string.hpp&#39; file not found</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;#include &lt;boost/algorithm/string.hpp&gt;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;         ^</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;1 error generated.</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;make: *** [test/prob/generate_tests] Error 1</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;make generate-tests -s failed</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;```</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;the library paths have not been configured correctly.</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;To test headers,</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;```</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;&gt; make test-headers</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;```</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;--------</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;# Questions</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;This would have been an &quot;faq,&quot; but nothing really gets asked frequently. We&#39;ll just collect thoughts on the Math library here.</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;## How do we keep consistent behavior in the Math library?</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;As of v2.18 (12/2018).</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;We try to keep the behavior of the functions in the Math library consistent for edge cases. Unfortunately, we implemented a lot of functions before we started realizing we should be consistent. That said, we prefer backwards compatibility to consistency -- we shouldn&#39;t change behavior until we get to a major version change. If we throw, we want well-formed messages because they do get passed back to the user from within Stan.</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;We follow these rules in order:</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;1. Existing functions should maintain their behavior.</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;2. Use the standard library&#39;s behavior. That means that we should be using the standard library functions for math if it exists.</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;3. Use Boost&#39;s math functions. If the error messages aren&#39;t nice, find some way to provide nice error messages.</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;## Why do we have `BOOST_DISABLE_ASSERTS` included in the C++ build?</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;Without including this, Boost will assert if certain inputs do not meet the preconditions of the function. Assertions are difficult to trap and recover from and we want to continue to have control over this behavior.</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;See [Discourse: Boost defines](https://discourse.mc-stan.org/t/boost-defines/10087) for more details.</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;--------</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;### Future topics to cover</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;- what goes in issues, pull requests, and the forums</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;- how to submit a pull request: requirements</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;- how to review a pull request</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;- A description of the map from Stan datatypes to C++ datatypes. (i.e. [stan -&gt; c++] -&gt; [vector[n] y -&gt; Eigen::Matrix&lt;double, Eigen::Dynamic, 1&gt;)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;- There is a way to visualize the objects put on the stack (stan::math::print_stack().) A description of this feature of Stan development would be cool, we obviously want the library as efficient as possible. If theres any other features like this we havent seen yet, please let us know!</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;- More in depth description of all of the memory management features unique to the stan library (i.e. stan::math::recover_memory()).</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;- Description of how to use/print the gradient functions in Stan, and any other diagnostic tools for making sure our code/math is accurate ( some_var_.grad(vars, grad)) and then (for (auto g : grad) { std::cout &lt;&lt; g &lt;&lt; std::endl;}</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;- How does the architecture from rev-&gt; prim work? I threw some print statements in gp_exp_quad_cov formerly (cov_exp_quad) to see how it works. rev fuctions are precompiled, and then call some of the prim functions on runtime? How does this work exactly? What kind of templating it happening to make sure rev is going to which prim? Can we have a quick visualization on a simple stan program to know whats happening?</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;- where to find doxygen: https://mc-stan.org/math</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;- Intro to C++ concepts needed to develop for Stan.</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;- Description of directory structure of the Stan source</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;- Guidelines for what should be in the Stan code and what should be in user specific functions.</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;- Walkthrough of how how to implement, something, required documentation, pull request process etc.</div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d5/dbb/developer__doc_8md.html">developer_doc.md</a></li>
    <li class="footer">
    <div class="contents" style="font-size:100%;">
      <span style="float:left; margin=0 1em 0 1em;">
      &nbsp;&nbsp;&nbsp;&nbsp;
      [ <a href="http://mc-stan.org/">Stan Home Page</a> ]
      </span>
      <span style="float:right; margin=0 1em 0 1em;">
      <i>&copy; 2011&ndash;2019,
      Stan Development Team.
      &nbsp;&nbsp;&nbsp;&nbsp;
      </i>
      </span>
    </div> </li>
  </ul>
</div>
</body>
</html>
